<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>FSTM ‚Äî Fireside Tier Maker</title>
    <link rel="stylesheet" href="style.css" />

    <!-- SortableJS: smooth, touch-friendly drag with no jitter -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js" defer></script>
    <!-- html-to-image: consistent PNG capture across devices -->
    <script src="https://cdn.jsdelivr.net/npm/html-to-image@1.11.11/dist/html-to-image.min.js" defer></script>
    <script src="script.js" defer></script>
  </head>
  <body>
    <header class="site-header" aria-label="FSTM header">
      <div class="brand">
        <svg class="brand-mark" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 2c3.5 3.4 4.5 6.3 3 8.7-1 1.6-3 2.3-3 5.3 0-.5-1.6-1.7-2.6-3.3C7.8 10.2 9 7.5 12 2z"></path>
          <circle cx="12" cy="19" r="3"></circle>
        </svg>
        <div class="brand-text">
          <strong class="brand-name">FSTM</strong>
          <span class="brand-sub">Fireside Tier Maker</span>
        </div>
      </div>

      <nav class="quick-actions" aria-label="Global actions">
        <button id="btn-add-tier" class="icon-btn" aria-label="Add a tier" title="Add a tier">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2h6z"/></svg>
        </button>

        <button id="btn-undo" class="icon-btn" aria-label="Undo" title="Undo last action" disabled>
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5V2L7 7l5 5V8c3.3 0 6 2.7 6 6a6 6 0 0 1-9.7 4.7l-1.2 1.6A8 8 0 0 0 20 14c0-4.4-3.6-8-8-8z"/></svg>
        </button>

        <button id="btn-save" class="icon-btn" aria-label="Save as PNG" title="Save as PNG">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M5 20h14v-8h-4v4H9v-4H5v8zM19 9l-7-7-7 7h4v4h6V9h4z"/></svg>
        </button>

        <button id="btn-clear" class="icon-btn" aria-label="Clear the board" title="Clear the board">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6 7h12l-1 14H7L6 7zm10.5-4l1 2H6.5l1-2H16.5z"/></svg>
        </button>

        <button id="btn-theme" class="icon-btn" aria-label="Toggle theme" title="Toggle dark / light">
          <svg class="icon-sun" viewBox="0 0 24 24" aria-hidden="true"><path d="M6.76 4.84l-1.8-1.79L3.17 4.84l1.79 1.79 1.8-1.79zM1 13h3v-2H1v2zm10 10h2v-3h-2v3zm9.83-18.16l-1.79-1.79-1.79 1.79 1.79 1.79 1.79-1.79zM20 13h3v-2h-3v2zM6.76 19.16l-1.8 1.79 1.79 1.79 1.8-1.79-1.79-1.79zM17.24 19.16l1.79 1.79 1.79-1.79-1.79-1.79-1.79 1.79zM12 6a6 6 0 100 12 6 6 0 000-12z"/></svg>
          <svg class="icon-moon" viewBox="0 0 24 24" aria-hidden="true"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
        </button>
      </nav>
    </header>

    <main>
      <!-- CUSTOM ITEMS group -->
      <section class="panel-group" aria-labelledby="custom-items-heading">
        <h2 id="custom-items-heading" class="panel-title">CUSTOM ITEMS</h2>
        <div class="panel-grid">
          <!-- Circle Creator -->
          <section class="panel" aria-labelledby="creator-heading">
            <div class="panel-header">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2a10 10 0 100 20 10 10 0 000-20z"/></svg>
              <h3 id="creator-heading">Circle Creator</h3>
            </div>
            <form id="circle-creator" class="creator-form" autocomplete="off">
              <label class="field">
                <span>Name or emoji</span>
                <input id="cc-text" type="text" maxlength="40" placeholder="e.g., ü¶Ü Emma, S-tier, etc." />
              </label>
              <label class="field">
                <span>Circle color</span>
                <input id="cc-color" type="color" value="#7C9EFF" />
              </label>
              <button id="cc-add" class="btn" type="submit" aria-label="Add custom circle">
                <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2h6z"/></svg>
                <span>Add to storage</span>
              </button>
            </form>
          </section>

          <!-- Image Upload -->
          <section class="panel" aria-labelledby="upload-heading">
            <div class="panel-header">
              <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M19 9l-7-7-7 7h4v4h6V9h4z"/></svg>
              <h3 id="upload-heading">Image Upload</h3>
            </div>
            <div class="upload-area">
              <input id="file-input" type="file" accept="image/*" multiple />
              <p class="hint">Drop images or choose files. They‚Äôll become circles.</p>
            </div>
          </section>
        </div>
      </section>

      <!-- HELP -->
      <section class="help panel" aria-labelledby="help-title">
        <div class="panel-header">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10a10 10 0 100-20zm0 4a4 4 0 00-4 4h2a2 2 0 114 0c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5a4 4 0 00-4-4z"/></svg>
          <h2 id="help-title">Help</h2>
        </div>
        <details>
          <summary>Tips for your device</summary>
          <ul>
            <li><strong>Desktop / iPad:</strong> drag circles between rows and storage. Reorder within a row by dragging anywhere; items animate into place.</li>
            <li><strong>Phones:</strong> tap a circle in storage to open the half-radial picker. Tap a tier letter to place it instantly. You can still drag to reorder within a row.</li>
            <li><strong>Undo:</strong> every change goes into the stack. Tap Undo to step back one by one.</li>
            <li><strong>PNG:</strong> ‚ÄúSave as PNG‚Äù captures the full board and title exactly as seen.</li>
            <li><strong>Autosave:</strong> your work is stored locally. Use ‚ÄúHard Reset‚Äù inside Clear to wipe it clean.</li>
          </ul>
        </details>
      </section>

      <!-- Capture wrapper: title + board -->
      <section id="capture-area">
        <!-- Editable Title -->
        <div class="title-wrap">
          <button id="title-edit" class="title-edit icon-btn" aria-label="Edit title" title="Edit title">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1 1 0 000-1.41l-2.34-2.34a1 1 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
          </button>
          <h1 id="board-title" class="editable" contenteditable="false" role="textbox" aria-multiline="true"
              aria-label="Tier board title" data-placeholder="Add a title‚Ä¶"></h1>
        </div>

        <!-- Tier Board -->
        <section id="tier-board" aria-label="Tier board">
          <!-- Tiers injected by JS -->
        </section>
      </section>

      <!-- Action Bar (duplicated in header for reachability) -->
      <section class="toolbar" aria-label="Board actions">
        <button id="btn-add-tier-2" class="btn">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2h6z"/></svg>
          <span>Add a tier</span>
        </button>
        <button id="btn-undo-2" class="btn" disabled>
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 5V2L7 7l5 5V8c3.3 0 6 2.7 6 6a6 6 0 0 1-9.7 4.7l-1.2 1.6A8 8 0 0 0 20 14c0-4.4-3.6-8-8-8z"/></svg>
          <span>Undo</span>
        </button>
        <button id="btn-save-2" class="btn">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M5 20h14v-8h-4v4H9v-4H5v8zM19 9l-7-7-7 7h4v4h6V9h4z"/></svg>
          <span>Save PNG</span>
        </button>
        <button id="btn-clear-2" class="btn">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M6 7h12l-1 14H7L6 7zm10.5-4l1 2H6.5l1-2H16.5z"/></svg>
          <span>Clear board</span>
        </button>
        <button id="btn-theme-2" class="btn">
          <svg class="icon-sun" viewBox="0 0 24 24" aria-hidden="true"><path d="M6.76 4.84l-1.8-1.79L3.17 4.84l1.79 1.79 1.8-1.79zM1 13h3v-2H1v2zm10 10h2v-3h-2v3zm9.83-18.16l-1.79-1.79-1.79 1.79 1.79 1.79 1.79-1.79zM20 13h3v-2h-3v2zM6.76 19.16l-1.8 1.79 1.79 1.79 1.8-1.79-1.79-1.79zM17.24 19.16l1.79 1.79 1.79-1.79-1.79-1.79-1.79 1.79zM12 6a6 6 0 100 12 6 6 0 000-12z"/></svg>
          <svg class="icon-moon" viewBox="0 0 24 24" aria-hidden="true"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
          <span>Theme</span>
        </button>
      </section>

      <!-- Image Storage -->
      <section class="storage panel" aria-labelledby="storage-title">
        <div class="panel-header">
          <svg viewBox="0 0 24 24" aria-hidden="true"><circle cx="12" cy="12" r="9"/></svg>
          <h2 id="storage-title">Image Storage</h2>
        </div>
        <div id="storage-grid" class="storage-grid" role="list" aria-label="Unplaced circles"></div>
      </section>
    </main>

    <!-- Mobile Half-Radial Picker -->
    <div id="radial" class="radial" aria-hidden="true" role="menu"></div>

    <!-- Clear confirm modal -->
    <dialog id="confirm-clear">
      <form method="dialog" class="confirm-card">
        <h3>Clear the whole board?</h3>
        <p>This removes all items from tiers and storage. You can also Hard Reset to wipe autosave.</p>
        <div class="modal-actions">
          <button value="cancel" class="btn ghost">Cancel</button>
          <button id="btn-hard-reset" value="hard" class="btn danger outline">Hard Reset</button>
          <button value="clear" class="btn danger">Clear Board</button>
        </div>
      </form>
    </dialog>

    <footer class="site-footer" aria-label="Footer">
      <small>Built for you with care. Tip: long-press a circle on phones to open its actions.</small>
    </footer>
  </body>
</html>